<% if @user %>
  <% (@user.password = @user.password_confirmation = nil) %>
  <%= error_messages_for :user %>
<% end %>
<section id="login">
<h1>Welcome guest</h1>

<%- if allow_signup? %>
  <%= form_for :user, :url => user_registration_path, :html => { :class => "sign-up" } do |f| %>
    <%= hidden_field_tag :invitation_token, params[:invitation_token] if params[:invitation_token] %>
    <fieldset>
      <legend>Get started by <strong>signing up</strong> (it's free)</legend>
      <label>
        <%= f.text_field :login, :placeholder => "user name" %>
        <span class="hint">min. 3 characters</span>
      </label>
      <label>
        <%= f.text_field :email, :placeholder => "email" %>
        <span class="hint">a valid email address</span>
      </label>
      <label>
        <%= f.password_field :password, :placeholder => "password" %>
        <span class="hint">min. 6 characters</span>
      </label>
      <label>
        <%= f.password_field :password_confirmation, :placeholder => "password" %>
        <span class="hint">repeat for confirmation</span>
      </label>
      <div>
        <%= button "sign up" %>
      </div>
    </fieldset>
  <%- end %>
<%- end %>

<%= form_for :user, :url =>  user_session_path, :html => { :class => "login #{'no-register' unless allow_signup?}" } do |f| -%>
  <fieldset>
    <%- if SystemPreferences.remote_ldap_sign_on == true %>
      <legend><strong>Log in</strong> with your ldap credentials</legend>
    <%- elsif node_privacy_settings["allow_registrations_for_strangers"] != true -%>
      <legend>Please <strong>log in!</strong></legend>
    <%- else %>
      <legend>or <strong>logging in</strong></legend>
    <%- end %>
    <label>
      <%= f.text_field :login, :placeholder => "user name", :id => "login_login" %>
    </label>
    <label>
      <%= f.password_field :password, :value => nil, :placeholder => "password", :id => "login_password" %>
    </label>
    <label for="user_remember_me">
      <%= f.check_box :remember_me %> <span class="hint">Keep logged in?</span>
    </label>
    <button type="submit" name="commit">login</button>
  </fieldset>
<%- end -%>
</section>