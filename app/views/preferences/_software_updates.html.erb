<h2><%= t("preferences.headline_updates") %></h2>
<p><%= t("preferences.text_updates") %></p>

<h3><%= t("preferences.headline_updates_info") %></h3>
<dl>
  <dt><%= t("preferences.label_current_version") %></dt><dd><%= SystemRelease.current_version %>/<%= SystemRelease.current_type %></dd>
  <dt><%= t("preferences.label_update_available") %></dt><dd><strong><%= raw(SystemRelease.most_recent? ? ('<span class="off">' + t("label_no") + '</span>') : ('<span class="on">' + t("label_yes") + '</span>')) %></strong></dd>
</dl>

<h3><%= t("preferences.headline_update") %></h3>
<%= form_tag(preferences_release_update_path, { :remote => true, 'data-type' => 'html', :class => "software-update" }) do %>
  <%= hidden_field_tag 'section', 'software_updates' %>
  <div class="form-field">
    <%= label_tag          :password, t("preferences.label_ssh_password") %>
    <%= password_field_tag :password, nil %>
    <a data-hover-hint="top" class="hint" title="<%= t("preferences.hint_ssh_password") %>">(?)</a>
  </div>
  <div class="form-field">
    <%= label_tag   :release, t("preferences.label_version") %>
    <%= select_tag  :release, options_for_select(SystemRelease.last_releases.reverse.map{|c| ["#{c[0]} / #{c[1]}", c[0]] if c[0].to_i >= SystemRelease.current_version}.compact, SystemRelease.last_releases.reverse.find {|release| release[1].strip! == "STABLE"}[0]) %>
  </div>
  <%= button t("preferences.label_update") %> <span class="loading-hint"><%= t("preferences.hint_please_wait") %></span>
  <a id="show-release-update-progress" class="hint"><%= t("preferences.link_show_update_progress") %></a>
<%- end %>

<h3><%= t("preferences.headline_update_log") %></h3>
<%= raw(t("preferences.text_update_log")) %>
<div id="release-update-progress-console" class="quake-style-console" data-url="<%= url_for preferences_release_update_progress_path %>">
  <div class="quake-style-console-content"></div>
  <%= form_tag(preferences_send_log_to_support_team_path, {
    :remote     => true,
    'class'     => 'single-button-form'
  }) do -%>
    <%= button t("preferences.label_send_log"), :id => "send-to-protonet-support" %>
  <%- end %>
  <div id="sent-feedback"></div>
</div>
